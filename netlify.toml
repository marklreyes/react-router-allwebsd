[build]
command = "react-router build"
publish = "build/client"
functions = "netlify/functions"

[functions]
node_bundler = "esbuild"

[functions.fetch-openai]
memory_size = 1024
timeout = 30

[functions.contact-simple]
timeout = 10

[build.environment]
VITE_RSS_URL = "http://rss.castbox.fm/everest/cc803d4a973f4758b2eafb046573d642.xml"

[dev]
command = "react-router dev"
functions = "netlify/functions"
publish = "public"
port = 8888

[[redirects]]
from = "/functions/*"
to = "/functions/:splat"
status = 200
force = true

# Assets should be served statically
[[redirects]]
from = "/assets/*"
to = "/assets/:splat"
status = 200
force = true

# Serve the static contact.html file for form processing only
[[redirects]]
from = "/contact.html"
to = "/contact.html"
status = 200
force = true

# SPA fallback - serve index.html for all routes (but after specific rules above)
[[redirects]]
from = "/*"
to = "/index.html"
status = 200
